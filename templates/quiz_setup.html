<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Quiz Setup — Quiz League</title>
  <link rel="stylesheet" href="/static/css/style.css" />
  <style>
    .container { max-width:820px; margin:36px auto; padding:18px; }
    .card { background:#fff; padding:18px; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.06); margin-bottom:16px; }
    .row { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    .btn { padding:10px 14px; border-radius:8px; cursor:pointer; border:none; font-weight:700; }
    .btn-primary { background:var(--accent); color:#fff; }
    .btn-ghost { background:#f3f3ff; color:#333; }
    .small { font-size:13px; color:#666; }
    label { font-weight:700; margin-right:8px; }
    select,input[type="number"] { padding:8px; border-radius:6px; border:1px solid #ddd; }
    .hide { display:none; }
  </style>
</head>
<body>

  <div class="container">

    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <h2>Quiz Setup</h2>
          <div class="small">Choose mode, subject, difficulty type, and start</div>
        </div>
        <div style="font-weight:700">Hello, {{ username }}</div>
      </div>
    </div>

    <div class="card">
      
      <!-- SUBJECT -->
      <label>Subject</label>
      <select id="setupSubject" style="margin-bottom:16px;">
        <option value="data_structures">Data Structures</option>
        <option value="cpp">C++</option>
      </select>

      <!-- MODE BUTTONS -->
      <label>Mode</label>
      <div class="row" id="modeButtons" style="margin:12px 0;">
        <button class="btn btn-ghost" data-mode="classic">Classic</button>
        <button class="btn btn-ghost" data-mode="rapid">Rapid</button>
        <button class="btn btn-ghost" data-mode="challenge">Challenge</button>
      </div>

      <!-- CLASSIC OPTIONS -->
      <div id="classicOptions" class="hide">
        <label>Number of questions</label>
        <div class="row" style="margin:12px 0;">
          <button class="btn btn-ghost" data-count="5">5</button>
          <button class="btn btn-ghost" data-count="10">10</button>
          <button class="btn btn-ghost" data-count="15">15</button>
        </div>
      </div>

      <!-- RAPID OPTIONS -->
      <div id="rapidOptions" class="hide">
        <label>Select timer</label>
        <div class="row" style="margin:12px 0;">
          <button class="btn btn-ghost" data-rapid="60">60 sec</button>
          <button class="btn btn-ghost" data-rapid="90">90 sec</button>
          <button class="btn btn-ghost" data-rapid="120">120 sec</button>
        </div>
      </div>

      <!-- CHALLENGE OPTIONS -->
      <div id="challengeOptions" class="hide">
        <p class="small" style="margin-top:10px;">
          Challenge Mode → 10 HARD questions • Bonus XP • Leaderboard boost
        </p>
      </div>

      <!-- START BUTTON -->
      <button id="startQuizConfig" class="btn btn-primary" style="margin-top:20px; width:100%;">Start Quiz</button>

    </div>

    <!-- BACK BUTTON -->
    <div class="card" style="text-align:center;">
      <button onclick="window.location.href='/'" class="btn btn-ghost" style="width:100%;">⬅ Back to Home</button>
    </div>

  </div>

  <script>
    let selectedMode = null;
    let selectedCount = null;
    let selectedRapid = null;

    const modeBtns = document.querySelectorAll("#modeButtons button");
    const classicBox = document.getElementById("classicOptions");
    const rapidBox = document.getElementById("rapidOptions");
    const challengeBox = document.getElementById("challengeOptions");

    modeBtns.forEach(btn => {
      btn.onclick = () => {
        // highlight selected
        modeBtns.forEach(b => b.classList.remove("btn-primary"));
        btn.classList.add("btn-primary");

        selectedMode = btn.dataset.mode;

        // show/hide
        classicBox.classList.add("hide");
        rapidBox.classList.add("hide");
        challengeBox.classList.add("hide");

        if (selectedMode === "classic") classicBox.classList.remove("hide");
        if (selectedMode === "rapid") rapidBox.classList.remove("hide");
        if (selectedMode === "challenge") challengeBox.classList.remove("hide");
      };
    });

    // classic question count
    document.querySelectorAll("[data-count]").forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll("[data-count]").forEach(b => b.classList.remove("btn-primary"));
        btn.classList.add("btn-primary");
        selectedCount = btn.dataset.count;
      }
    });

    // rapid time choices
    document.querySelectorAll("[data-rapid]").forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll("[data-rapid]").forEach(b => b.classList.remove("btn-primary"));
        btn.classList.add("btn-primary");
        selectedRapid = btn.dataset.rapid;
      }
    });

    document.getElementById("startQuizConfig").onclick = () => {
      if (!selectedMode) {
        alert("Please select a mode.");
        return;
      }

      const subject = document.getElementById("setupSubject").value;

      let query = `/quiz/start?subject=${subject}&mode=${selectedMode}`;

      if (selectedMode === "classic" && selectedCount)
        query += `&count=${selectedCount}`;

      if (selectedMode === "rapid" && selectedRapid)
        query += `&time=${selectedRapid}`;

      window.location.href = query;
    };
  </script>

</body>
</html>
